input = "                                                                                         |
   +-------+                                         +-+ +-------------------------------------------------------------------------+   +-+   +-----------------------------------------+   +-+   +---+
   |       |                                         | | |                               |                                         |   | |   |                                         |   | |   |   |
   |       |                                         | +-|---------------+       +---------+   +---------------------------------------|---------------------------+                   |   | |   |   |
   |       |                                         |   |               |       |       | |   |                                   |   | |   |                     |                   |   | |   |   |
   |       |                                         |   +-------------------------------|-----------------------------------------|---|-|---|---------------------|-----------------+ |   | |   |   |
   |       |                                         |                   |       |       | |   |                                   |   | |   |                     |                 | |   | |   |   |
   |       |                                   +-------+   +-----------+ |       +-----+ | |   |                 +---------------+ |   | |   |     +---------------+       +---------+ |   | |   |   |
   |       |                                   |     | |   |           | |             | | |   |                 |               | |   | |   |     |                       |           |   | |   |   |
   |   +---------------------------------------------|-----------------|-|-----+       | | |   |                 +---------------|-|---------------|-------------------+   |           |   | |   |   |
   |   |   |                                   |     | |   |           | |     |       | | |   |                                 | |   | |   |     |                   |   |           |   | |   |   |
   +-------|-----+                             |     | |   |     +---------------------|---|---|-----------------------------------|-+ | |   |     |                   |   |           |   | |   |   |
       |   |     |                             |     | |   |     |     | |     |       | | |   |                                 | | | | |   |     |                   |   |           |   | |   |   |
   +-+ |   +-----------------------------------------------------|-----|-|-------------|-|-|---|---------------------------------|-|-|-|-|---|-----|-------------------|---|-----+     |   | |   | +---+
   | | |         |                             |     | |   |     |     | |     |       | | |   |                                 | | | | |   |     |                   |   |     |     |   | |   | | | |
   | | |         |     +-----------------------|-----|-----------|-----|-|-----|---------|---------------------------+       +---+ +-|-|-----------|-----------+ +-----+   |     |     |   | |   +-|-|-+
   | | |         |     |                       |     | |   |     |     | |     |       | | |   |                     |       |       | | |   |     |           | |         |     |     |   | |     | |
   | | +---------|-----------------------------------|-----|-----|-----|-----------------|-|-------------------------|-------|---------|-|-+ |     | +-----+   | |         |     |     |   | |     | |
   | |           |     |                       |     | |   |     |     | |     |       | | |   |                     |       |       | | | | |     | |     |   | |         |     |     |   | |     | |
   | |           |     |   +-------+           |     | |   |     +-----------------------|-----|-+                   |       |       | | | | |     | |     |   | |         |     |     |   | | +---+ |
   | |           |     |   |       |           |     | |   |           | |     |       | | |   | |                   |       |       | | | | |     | |     |   | |         |     |     |   | | |     |
   | |           |     |   |       |           |     | |   |           | |     |       | | |   | |                   |       |       | | | | |     | |     |   | |         |     |     |   | | |     |
   | |           |     |   |       |           |     | |   |           | |     |       | | |   | |                   |       |       | | | | |     | |     |   | |         |     |     |   | | |     |
   | |           |     |   |       |           |     | |   | +-----------|-----|-----------|---|-+                   |       |     +---|-------------|---------|-----------------------|---|---|-------+
   | |           |     |   |       |           |     | |   | |         | |     |       | | |   |                     |       |     | | | | | |     | |     |   | |         |     |     |   | | |     | |
   | |           |     |   |       |           |     | |   | |         | |     |       +-|-----------------------------------------|-+ | | | |     | +-----|---|-----+     |     |     |   | | |     | |
   | |           |     |   |       |           |     | |   | |         | |     |         | |   |                     |       |     |   | | | |     |       |   | |   |     |     |     |   | | |     | |
   | |       +---------|-----------|-----------|-----|-----|-----------|---------------+ | |   |                     |       |     | +---|-|---------------|---|-|---+     |     +---+ |   | | |     | |
   | |       |   |     |   |       |           |     | |   | |         | |     |       | | |   |                     |       |     | | | | | |     |       |   | |         |         | |   | | |     | |
   | |       |   | +---|-------+   +-----------------|-----|-|---------+ |     |       | | |   |                     |       |     | | | | | |   +-------------|-|---------+         | |   | | |     | |
   | |       |   | |   |   |   |               |     | |   | |           |     |       | | |   |                     |       |     | | | | | |   | |       |   | |                   | |   | | |     | |
   | |       |   | |   |   |   |               |     | |   | |           |     |       | | |   |                     |       |     | | | | | |   | +---+ +-------|-+                 | |   | | |     | |
   | |       |   | |   |   |   |               |     | |   | |           |     |       | | |   |                     |       |     | | | | | |   |     | | |   | | |                 | |   | | |     | |
   | |       |   | |   |   |   |               |     | |   | |         +-------|-------|-|-|-------------+           |       |     | | | | | | +-|-+   | | |   | | +-+ +-------+   +-------|---|---+ | |
   | |       |   | |   |   |   |               |     | |   | |         | |     |       | | |   |         |           |       |     | | | | | | | | |   | | |   | |   | |       |   | | |   | | |   | | |
   | |       |   | |   |   |   |               |     | |   | |         | |     +-----+ | +---------------|-------------------|-----------|---|-|-|-|-------|---|---+ +---------------+ |   | | |   | | |
   | |       |   | |   |   |   |               |     | |   | |         | |           | |   |   |         |           |       |     | | | | | | | | |   | | |   | | |   |       |   |   |   | | |   | | |
   | |       | +-|-----|-------------------+   |     | |   | |         | |           | |   |   |         |   +-------|-------------|---|-|-|---+ | |   | | |   | | |   |       +-----------|---|-+ | | |
   | |       | | | |   |   |   |           |   |     | |   | |         | |           | |   |   |         |   |       |       |     | | | | | |   | |   | | |   | | |   |           |   |   | | | | | | |
   | |       | | | |   | +---------------------+     | |   | |       +-+ |         +-------|---|-----------------+   |       |     | | | | | |   | |   | | |   | | |   |           |   |   | | | | | | |
   | |       | | | |   | | |   |           |         | |   | |       |   |         | | |   |   |         |   |   |   |       |     | | | | | |   | |   | | |   | | |   |           |   |   | | | | | | |
   | |       | | | |   | | |   |     +-----|------L--|-------------------|-------------|---|---------------------|---|-------|---+ | | | | | | +-------|-+ |   | | |   |       +-----------+ | | | | | |
   | |       | | | |   | | |   |     |     |         | |   | |       |   |         | | |   |   |         |   |   |   |       |   | | | | | | | | | |   |   |   | | |   |       |   |   |     | | | | | |
   | |   +---------------------------------|-----------|---|-----------------------|-------|---|---------|---|---------------|---------|-|---|---|-------------|-|-|---+       |   |   |     | | | | | |
   | |   |   | | | |   | | |   |     |     |         | |   | |       |   |         | | |   |   |         |   |   |   |       |   | | | | | | | | | |   |   |   | | |           |   |   |     | | | | | |
   | |   |   | | +-------+ +---|-----|-----|-----------------|-----------+     +---------------|-------------|---------------|-----|-------|---|-+ |   |   |   | | |           |   +-+ |     | | +-+ | |
   | |   |   | |   |   |       |     |     |         | |   | |       |         |   | | |   |   |         |   |   |   |       |   | | | | | | | |   |   |   |   | | |           |     | |     | |     | |
   | |   +---|-----|---|---+   |     |     |         | |   | |       |         |   | | |   |   |         |   |   |   |       |   | | | | | | | |   |   |   |   | | |           |     | |     | |     | |
   | |       | |   |   |   |   |     |     |         | |   | |       |         |   | | |   |   |         |   |   |   |       |   | | | | | | | |   |   |   |   | | |           |     | |     | |     | |
   | |       | +---+ +---+ | +-|-----|-----|---------------|-|-------------------------|---|---------------------------------|-----|-|-----|-|-|---|-------|-------|-----------|-----|---------------+ |
   | |       |       | | | | | |     |     |         | |   | |       |         |   | | |   |   |         |   |   |   |       |   | | | | | | | |   |   |   |   | | |           |     | |     | |       |
   | |       |       | | | | | |     |     |         | |   | |       |         |   | | |   +---|---------|-------|---|-+     |   | | | | | | | |   |   |   |   | | | +-+       |   +---|-----|-+       |
   | |       |       | | | | | |     |     |         | |   | |       |         |   | | |       |         |   |   |   | |     |   | | | | | | | |   |   |   |   | | | | |       |   | | |     |         |
   | |       |       | | | | | |     |     |         | |   | |       |         |   | | +-------------------------|---|-|---------|-|---|-|-|-|-|-----------|---|---|---|-------|---|-|-|-----|-+       |
   | |       |       | | | | | |     |     |         | |   | |       |         |   | |         |         |   |   |   | |     |   | | | | | | | |   |   |   |   | | | | |       |   | | |     | |       |
   | |       +-+     | | | | | |     |     |         | +-----+       |         |   | |         |         +-------------|-----|-----|-|-------|-----|-----------|-+ | | |       |   | | |     | |       |
   | |         |     | | | | | |     |     |         |     |         |         |   | |         |             |   |   | |     |   | | | | | | | |   |   |   |   |   | | |       |   | | |     | |       |
   | |         |     | | | | | |     |     |         |     |         |         |   | |         |             |   |   | |     |   | | | | | | | |   |   |   +---|---|---|-----------+ | |     | |       |
   | |         |     | | | | | |     |     |         |     |         |         |   | |         |             |   |   | |     |   | | | | | | | |   |   |       |   | | |       |     | |     | |       |
   | |         |     | | | | | |   +-|-----+   +-----|-----|-------------------|-----------------------------|-------|-|-----|---|---|---|-------------|-------|---|-|---------|-+   | |     | | +-+   |
   | |         |     | | | | | |   | |         |     |     |         |         |   | |         |             |   |   | |     |   | | | | | | | |   |   |       |   | | |       | |   | |     | | | |   |
   | |         |     | | | | | |   | |         |     |     |         |         |   | |   +-------------------|---------------------|---|---|-|-|-------|-------|-----|---------|-----|-----------+ |   |
   | |         |     | | | | | |   | |         |     |     |         |         |   | |   |     |             |   |   | |     |   | | | | | | | |   |   |       |   | | |       | |   | |     | |   |   |
 +---|---------------|---|-|-|-|---|-|---------|-----|---------------|---------|---------|-------------------|---|-----|-------+ | | | | | | | |   |   |       | +-|-|-----+   | |   | |     | |   |   |
 | | |         |     | | | | | |   | |         |     |     |         |         |   | |   |     |             |   |   | |     | | | | | | | | | |   |   |       | | | | |   |   | |   | |     | |   |   |
 | | |         |     | | | | | |   | |         |     |     |         |   +-----|---------------|-----------------|---|-|-------|-|---|-+ | | +-----|-----+     | | | | |   |   | |   | |     | |   |   |
 | | |         |     | | | | | |   | |         |     |     |         |   |     |   | |   |     |             |   |   | |     | | | | |   | |   |   |   | |     | | | | |   |   | |   | |     | |   |   |
 | | |         |     | | | | | |   | |     +---------|-----|-------------|-----|---------|-----|-----------------|---|---------|-----|---------|---|-----------|-+ | | |   |   | |   | |     | |   +-+ |
 | | |         |     | | | | | |   | |     |   |     |     |         |   |     |   | |   |     |             |   |   | |     | | | | |   | |   |   |   | |     |   | | |   |   | |   | |     | |     | |
 | | |         |     | | | | | |   | |     |   |     |     |     +-----------------------|-------------------|---|---|-|-------|-------------------|-----|-------------|-------+ |   | |   +-----+   | |
 | | |         |     | | | | | |   | |     |   |     |     |     |   |   |     |   | |   |     K             |   |   | |     | | | | |   | |   |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | +-------+ | | | +---|---------|-----------|-------------------------|--W--------------------|-------|-|-----|-|-|-|-----|-|-+ |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | |   | |   | | | | | |     |   |     |     |     |   |   |     |   | |   |     |             |   |   | |     | | | | |   | | | |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | |   | |   | | | | | |     |   |     | +---|-----|---|---------|---|-|---|---------------+   |   |   | |     | | | | |   | | | |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | |   | |   | | | | | |     |   |     | |   |     |   |   |     |   | |   |     |         |   |   |   | |     | | | | |   | | | |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | |   | |   | | | | | |     |   |     | |   |     |   |   |     |   | |   |     |         |   |   |   | |     | | | | |   | | | |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | |   | |   | | | | | |     |   |     | |   |     |   |   |     |   | |   |     |         |   |   |   | |     | | | | |   | | | |   |   | |     |   | | |   |     |   | |   | | | |   | |
 | | |         | |   | |   +-|-|---|-|---------|-----|-----------|---|-------------|-|---|-----|-----------------|---|-|-------------------|-|-------+ | |     |   | +-|---|-----|---|-|---|---|---+ | |
 | | |         | |   | |     | | | | |     |   |     | |   |     |   |   |     |   | |   |     |         |   |   |   | |     | | | | |   | | | |   | | | |     |   |   |   |     |   | |   | | | | | | |
 | | |         +-+   | |   +-|---|---------|---------|-|---|-----|---|---|-----|---------|-----|-----------------------|-------|---|-|---|-|-|-|-----|---|-----|-------|---+     |   | |   | | | | | | |
 | | |               | |   | | | | | |     |   |     | |   |     |   |   |     |   | |   |     |         |   |   |   | |     | | | | |   | | | |   | | | |     |   |   |         |   | |   | | | | | | |
 | | |               | | +---|---|-------------------------|-----|---|---------|-------------------------+   |   |   | |     | | | | |   | | | +-----|-|-|-----|-------|-----+   |   | |   | | | | | | |
 | | |               | | | | | | | | |     |   |     | |   |     |   |   |     |   | |   |     |             |   |   | |     | | | | |   | | |     | | | |     |   |   |     |   |   | |   | | | | | | |
 | | |               | | | | | | | | |     |   |     | |   |     |   |   |     |   | |   |     | +-----------|-----------------|-|-|-|-+ | | |     | | | |     |   |   |     |   |   | |   | | | | | | |
 | | |               | | | | | | | | |     |   |     | |   |     |   |   |     |   | |   |     | |           |   |   | |     | | | | | | | | |     | | | |     |   |   |     |   |   | |   | | | | | | |
 | | |               | | | | | | | | |     |   |     | |   |     |   |   |     |   +-----+     | |           |   |   | |     | | | | | | | | |     | | | |     |   |   |     |   |   | |   | | | | | | |
 | | |               | | | | | | | | |     |   |     | |   |     |   |   |     |     |         | |           |   |   | |     | | | | | | | | |     | | | |     |   |   |     |   |   | |   | | | | | | |
 | | |           +---|-|---|---------------|---------|-|---|-----|---|---|-----|-----|---+     | |           |   |   | |     | | | | | | | | |     | | | |     |   +---------------+ | |   | | | | | | |
 | | |           |   | | | | | | | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   | |     | | | | | | | | |     | | | |     |       |     |   | | | |   | | | | | | |
 | | |           |   +-------|-+ | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   | |     | | | | | | | | |     | | | |     |       |     |   | | | |   | | | | | | |
 | | |           |     | | | |   | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   | |     | | | | | | | | |     | | | |     |       |     |   | | | |   | | | | | | |
 | | |     +-----------|-|-|-----|---------|---|---------------------|---|-----------|---|-------|-------------------|-+     | | | | | | | | |     | | | |     |       |     |   | | | |   | | | | | | |
 | | |     |     |     | | | |   | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   |       | | | | | | | | |     | | | |     |       |     |   | | | |   | | | | | | |
 | | |     |   +-|-----|-|-|---------|---------------|-----|-----|---|---------|-----|---|-------|-------------------|-----------|-----|-|---|-----|---|-|-----|-------|---------+ | | |   | | | | +-+ |
 | | |     |   | |     | | | |   | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   |       | | | | | | | | |     | | | |     |       |     |     | | |   | | | |     |
 | | +---------|---------|---+   | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   |       | | | | | | | | |     | | | |     |       |     |     | | |   | | | |     |
 | |       |   | |     | | |     | | |     |   |     | |   |     |   |   |     |     |   |     | |           |   |   |       | | | | | | | | |     | | | |     |       |     |     | | |   | | | |     |
 | | +-----|---|-+   +-|---+     | | |     |   |     | |   |     +-------|---------------------|-|-------+   |   |   |       | | | | | | | | |     | | | |     |       |     |     | | |   | | | |     |
 | | |     |   |     | | |       | | |     |   |     | |   |         |   |     |     |   |     | |       |   |   |   |       | | | | | | | | |     | | | |     |       |     |     | | |   | | | |     |
 | | |     |   |     +-|-----+   | | |     |   |     | |   |         |   |     |     |   |     | |       |   |   |   |       | +-|-|-+ | +---------|---|---+   |       |     |     | | |   | | | |     |
 | | |     |   |       | |   |   | | |     |   |     | |   |         |   |     |     |   |     | |       |   |   |   |       |   | |   |   | |     | | | | |   |       |     |     | | |   | | | |     |
 | | +-----------------|-|-------|-+ |     |   |     | |   |         |   |     |     |   |     | |       | +-|-------|-----------|---------|-|---------|---+   |       |     |     | | |   | | | |     |
 | |       |   |       | |   |   |   |     |   |     | |   |         |   |     |     |   |     | |       | | |   |   |       |   | |   |   | |     | | | |     |       |     |     | | |   | | | |     |
 | |       |   |       | |   |   |   |     |   |     | |   |         |   |     +-----|---|---------------------------|-------------+   |   | |     | | | |     |       |     |     | | |   | | | |     |
 | |       |   |       | |   |   |   |     |   |     | |   |         |   |           |   |     | |       | | |   |   |       |   |     |   | |     | | | |     |       |     |     | | |   | | | |     |
 | | +-----|---|-------|-|---|-------|---------|-----|-|---|-------------|-----------------------------------|---------------|---------|-------------+ | |     |       |     |     | | |   | | | |     |
 | | |     |   |       | |   |   |   |     |   |     | |   |         R   |           |   |     | |       | | |   |   |       |   |     |   | |     |   | |     |       |     |     | | |   | | | |     |
 | | |     |   |     +-|-|-------|---------|---|-------|---------------------------------------|-|-------|-|-|---------------|---|---------|-|-----|---|---------------|-+   |     | | |   | | | |     |
 | | |     |   |     | | |   |   |   |     |   |     | |   |         |   |           |   |     | |       | | |   |   |       |   |     |   | |     |   | |     |       | |   |     | | |   | | | |     |
 | | |     |   |     +-|-|---|-------------|---|-------|-------------+   |           |   |   +-|-|-------|-|-|---|---------------------|---+ |     |   | |     |       | |   |     | | |   | | | | +-+ |
 | | |     |   |       | |   |   |   |     |   |     | |   |             |           |   |   | | |       | | |   |   |       |   |     |     |     |   | |     |       | |   |     | | |   | | | | | | |
 | +-|-----|-------------------------------|---|-----|-|---------------------------------|---+ | | +-----|-|-|---|---|-----------------|-----------+   | |     |       | |   |     | | |   | | | | | | |
 |   |     |   |       | |   |   |   |     |   |     | |   |             |           |   |     | | |     | | |   |   |       |   |     |     |         | |     |       | |   |     | | |   | | | | | | |
 |   |     |   | +-----------|---|---|-----|-----------|---|-------------|-----------|---|-----+ | +-------|-|---|---|---------------------------------|-------|-----+ | | +---+   | | |   | | | | | | |
 |   |     |   | |     | |   |   |   |     |   |     | |   |             |           |   |       |       | | |   |   |       |   |     |     |         | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   |   |   |     |   |     | |   |             |           |   |   +-------------------------------|---|---------------+ +-+ | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   |   |   |     |   |     | |   |             |           |   |   |   |       | | |   |   |       |   |     |     |   | | | | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   |   |   |     |   |     | |   |             |           |   |   |   |       | | |   |   |       |   |     |     | +---|-+ | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   |   |   |     |   |     | |   |             |           |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   |   | +-----------------|-|---|-------------+ +-+       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   |   | | |     |   |     | |   |               | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |   +-----|-----------|-----|-----------+         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | |   | | | | | | |
 |   |     |   | |     | |       | | |     |   |     | |   |     |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | |   | | | | | | |
 | +-|-----|---------+ | |       | | |     |   |     | |   |     |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | | +-+ | | | | | |
 | | |     |   | |   | | |       | | |     |   |     | |   |     |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | | |   | | | | | |
 | | |     |   | |   | | |       | | |     |   |     | |   |     |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | | |   | | | | | |
 | | |     |   | |   | | |       | | |     |   |     | |   |     |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   | |     |     | | | | | |   | | | |   | | | | | |
 +---|-----|-----|-----|-|-------+ | |     |   |     | |   |   +-|---------|-|-----------|-------|-------|-------|---|-------|---|-----|---------|-----|-+     | +-+ | | +-+ | |   | | | |   +-|-+ | | |
   | |     |   | |   | | |         | |     |   |     | |   |   | |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   |       | | | | |     | |   | | | |     |   | | |
 +---|-----|-----+   | | |         | | +---|---|-------|---|-----|---------|-|---------------|---|-------|-|-|---|---------------|-----|-----|-|-------|-------|---|-----+   | |   | | | |     |   | | |
 | | |     |   |     | | |         | | |   |   |     | |   |   | |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   |       | | | | | |   | |   | | | |     |   | | |
 | | |     |   |     | | |         | | |   |   |     | |   |   | |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   |       | | | | | |   | |   | | | |     |   | | |
 | | |     |   |     | | |         | | |   |   |     | |   |   | |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   |       | | | | | |   | |   | | | |     |   | | |
 | | |     |   |     | | |         | | |   |   |     | |   |   | |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   |       | | | | | |   | |   | | | |     |   | +-+
 | | |     |   |     | | |         | | |   |   |     | |   |   | |         | |       |   |   |   |       | | |   |   |       |   |     |     | | | |   |       | | | | | |   | |   | | | |     |   |
 | | |     |   |     | | |         | | |   |   |     | |   |   +-|---------|-------+ |   | +-|---|-------|-------|-----------|---------|-----+ | | |   |       | | | | | |   | |   | | | |     | +-|---+
 | | |     |   |     | | |         | | |   |   |     | |   |     |         | |     | |   | | |   |       | | |   |   |       |   |     |       | | |   |       | | | | | |   | |   | | | |     | | |   |
 | | |     |   |     | | |         | | |   |   |     | |   |     |         | |     | |   | | |   |       | | |   |   |       |   |     |       +-|-|-------+   | | | | | +---------|-----|-----|-+ |   |
 | | |     |   |     | | |         | | |   |   |     | |   |     |         | |     | |   | | |   |       | | |   |   |       |   |     |         | |   |   |   | | | | |     | |   | | | |     |   |   |
 | | |     |   |     | | |         | | |   | +---------|---------|---------|--Q------|-------------------|-----------------------------|---------|-----|---|---|---|-|---+   | |   | | | |     |   |   |
 | | |     |   |     | | |         | | |   | | |     | |   |     |         | |     | |   | | |   |       | | |   |   |       |   |     |         | |   |   |   | | | | | |   | |   | | | |     |   |   |
 | | |     |   |   +-|-----------------|-----|-|-----------------|---------+ |     | |   | | |   |       | | |   |   |       |   |     |         | |   |   |   | | | | | |   | |   | | | |     |   |   |
 | | |     |   |   | | | |         | | |   | | |     | |   |     |           |     | |   | | |   |       | | |   |   |       |   |     |         | |   |   |   | | | | | |   | |   | | | |     |   |   |
 | | |     |   |   | | | |         +---|---|-|-+     | |   |     |           |     +-----|-|-|-+ |       | | |   |   |       |   |     |         | |   +---|-------|---+ |   | |   | | | |     |   |   |
 | | |     |   |   | | | |           | |   | |       | |   |     |           |       |   | | | | |       | | |   |   |       |   |     |         | |       |   | | | |   |   | |   | | | |     |   |   |
 | | |     +-----------|-|-----------|-|-+ | |       | +---|-----|-----------|-------|-------------------|-------------------|---------|-------------------|---|-|-------+   | |   +-|-+ |     |   |   |
 | | |         |   | | | |           | | | | |       |     |     |           |       |   | | | | |       | | |   |   |       |   |     |         | |       |   | | | |       | |     |   |     |   |   |
 | | |         |   | | | |           | | +-----------------|-----|-----------------------|-|-----+       +----I--|-----------|-----------------------------|-----|-+ |       | |     |   |     |   |   |
 | | |         |   | | | |           | |   | |       |     |     |           |       |   | | | |           | |   |   |       |   |     |         | |       |   | |   |       | |     |   |     |   |   |
 | | |         |   | | | |           | |   | |       |     |     |           |       |   | | | |           | |   |   |       |   |   +-|-----------|---------------+ |       | |     |   |     |   |   |
 | | |         |   | | | |           | |   | |       |     |     |           |       |   | | | |           | |   |   |       |   |   | |         | |       |   | | | |       | |     |   |     |   |   |
 | | | +-+     | +---|---|-----------|-----|-|-------------|-----|-----------|---------------|-------------|---------+       |   |   | |         | |       |   | | | |       | |     |   |     |   |   |
 | | | | |     | | | | | |           | |   | |       |     |     |           |       |   | | | |           | |   |           |   |   | |         | |       |   | | | |       | |     |   |     |   |   |
 | | | | |     | | | | +-|-----------|-|---|-|-------------|-------------------------|---|-|-|-|---------+ | |   |           |   |   | |         | +-------|---|-|---|-------|-|---+ |   |     |   |   |
 | | | | |     | | | |   |           | |   | |       |     |     |           |       |   | | | |         | | |   |           |   |   | |         |         |   | | | |       | |   | |   |     |   |   |
 | | | | |     | | | |   |       +---+ |   | |       |     |     |           |       |   | | | |         | | |   |           |   |   | |         |         | +-----+ |       | |   +-|-----------------+
 | | | | |     | | | |   |       |     |   | |       |     |     |           |       |   | | | |         | | |   |           |   |   | |         |         | | | |   |       | |     |   |     |   |
 | | | | |     +-+ +-------------|---+ |   | |       |     |     |           |       |   | | | |         | | |   |           |   |   | +---------------------+ | |   |       | |   +-----+     |   |
 | | | | |           |   |       |   | |   | |       |     |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   | +-+ | |       |     |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   | | |       |     |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   | +---------|---+ |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   |   |       |   | |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   |   |       |   | |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   |   |       |   | |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   |   |       |   | |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | |           |   |       |   |   |   |       |   | |     |           |       |   | | | |         | | |   |           |   |   |           |         |   | |   |       | |   | |         |   |
 | | | | | +---------|---|-------|-----------|-----------|-|-----|-----------|-------+   | | | |   +-------|-----|-----------|-------|-----------|---------|-----|---+       | |   | |         |   |
 | | | | | |         |   |       |   |   |   |       |   | |     |           |           | | | |   |     | | |   |           |   |   |           |         |   | |           | |   | |         |   |
 | | | | | | +-------+   |       |   |   |   |       |   | |     +-----------|-----------|-----|---|-----|-|-----|-----+     +---|---------------|---------+   +-------------|-----+ |         |   |
 | | | | | | |           |       |   |   |   |       |   | |                 |           | | | |   |     | | |   |     |         |   |           |               |           | |     |         |   |
 | | | | | | |           |       +-+ |   |   |       |   | |                 |           | | | |   |     | | |   |     |         |   |           |               |         +---|-+   |         |   |
 | | | | | | |           |         | |   |   |       |   | |                 |           | | | |   |     | | |   |     |         |   |           |               |         | | | |   |         |   |
 | | | | | | |     +---------------------|---|-------|-------------------------------------|-------|-------|-+   |     |         |   |           |               |         | | | |   |         |   |
 | | | | | | |     |     |         | |   |   |       |   | |                 |           | | | |   |     | |     |     |         |   |           |               |         | M | |   |         |   |
 +-+ | +---|-------------------------|---|---|-------------------------------------------|---|-------------------------------------------+       |           +-------+     | | | |   |         |   |
     |   | | |     |     |         | |   |   |       |   | |                 |           | | | |   |     | |     |     |         |   |   |       |           |   |   |     | | | |   |         |   |
   +---------+     |     |         | |   |   |       +-----------------------|-----------+ | | |   |     | |     |     |         |   |   |       |           |   |   |     | | | |   |         |   |
   | |   | |       |     |         | |   |   |           | |                 |             | | |   |     | |     |     |         |   |   |       |           |   |   |     | | | |   |         |   |
   | |   | |       |     |         | |   |   |           | |                 |             +-|-|---|-----|-+     |     |         |   |   |       |           |   |   |     | | | |   |         |   |
   | |   | |       |     |         | |   |   |           | |                 |               | |   |     |       |     |         |   |   |       |           |   |   |     | | | |   |         |   |
   | |   | |       +-----------------+   |   |           | |   +-----------------------------|-----|-----|-------|-----+         |   |   |       |           |   |   |     | | | |   |         |   |
   | |   | |             |         |     |   |           | |   |             |               | |   |     |       |               |   |   |       |           |   |   |     | | | |   |         |   |
 +-+ |   | |             |         |     |   |           +-----|-------------|---------------|-----------|---+   |               |   +---|-------|---------------|---+   +-|-|---+   |         |   |
 |   |   | |             |         |     |   |             |   |             |               | |   |     |   |   |               |       |       |           |   |       | | | |     |         |   |
 | +-|-----|-------------|---------|---------|-------------+   |             |               | +---|-----|---|-------------------+       |       |           +---|---------+ | |     |         |   |
 | | |   | |             |         |     |   |                 |             |               |     |     |   |   |                       |       |               |       |   | |     |         |   |
 | | |   +-|-----------------------|-+   +---|-----------+     |             |               +-----|-------------------------------------|-------|-----------------------|-----------+         |   |
 | | |     |             |         | |       |           |     |             |                     |     |   |   |                       |       |               |       |   | |               |   |
 | | |     | +---------+ |         | +---------------------------------------|--Y------------------|-----|---|-----------------------------------|-------------------+   |   +-----------------+   |
 | | |     | |         | |         |         |           |     |             |                     |     |   |   |                       |       |               |   |   |     |                   |
 | | |     | |         | |         |         |           +-----------------------------------------|---------+   |                       |       |               |   |   |     |                   |
 | | |     | |         | |         |         |                 |             |                     |     |       |                       |       |               |   |   |     |                   |
 | | |     +-----------|-|---------|---------|-------------+ +-+             +---------------------------------------------------------------------------------------+ +-+     |                   |
 | | |       |         | |         |         |             | |                                     |     |       |                       |       |               |     |       |                   |
 | | |       |         +-+         |         |             | +-+ +---------------------------------+     +-------------------------------|-------|---------------+     |       |                   |
 | | |       |                     |         |             |   | |                                               |                       |       |                     |       |                   |
 | | |       +-+                   +-----------------------|---|---------------------------------------------------------------------------------|---------------------|-------|-+                 |
 | | |         |                             |             |   | |                                               |                       |       |                     |       | |                 |
 +-+ +---------+                             +-------------+ P-+ +-----------------------------------------------+                       +-------+                     +-------+ +-----------------+     "


grid = []
input.split("\n").each do |line|
  row = []
  line.split("").each do |cell|
    row << cell
  end
  grid << row
end

posX = grid[0].index("|")
posY = 0
answer = []
directionX = 0
directionY = 1


def isValidTile(x, y, grid)
  if grid[y].nil?
    return false
  end

  if grid[y][x].nil?
    return false
  end

  if grid[y][x] == ' '
    return false
  end

  return true
end

count = 0
while true
  case grid[posY][posX]
  when '|', '-'
    # continue...
  when '+'
    # find new direction
    if directionY.abs > 0
      if isValidTile(posX+1, posY, grid)
        directionX = 1
      else
        directionX = -1
      end
      directionY = 0
    else
      if isValidTile(posX, posY+1, grid)
        directionY = 1
      else
        directionY = -1
      end
      directionX = 0
    end
  when ' '
    break
  else
    answer << grid[posY][posX]
  end

  posX += directionX
  posY += directionY
  count += 1
end

puts "#{answer.join} in #{count} steps"
